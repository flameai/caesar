# User - Group assigning service (Caesar)

## Demostration for microservice architecture and rational coding practices

### Предполагаемый контракт сервиса

1. Получение пользователей из списка в БД
2. Получение групп пользователей
3. Получение принадлежности пользователя к группам в БД
4. Изменение принадлежности пользователя к группе
5. Получение истории изменения членств
6. Изменение членства пользователя в группах
7. Изменение группы (добавление пользователей в группу)
8. Наличие cli-интерфейса
9. Наличие возможности подключения оповещений через очередь сообщений при изменении членств

Требования:

1. Пользователю можно изменить принадлежность к конкретной группе только один раз в
   интервал времени (задается переменной среды)
2. Нагрузка на сервис не менее 600 rps
3. Возможность горизонтального масштабирования приложения.
4. Возможность менять стратегию массового изменения членств:
   а) если хотя бы одно членство невозможно модифицировать, то вся операция отменяется
   б) если какие-то из членств не смогли быть изменены, то просто выдаем информацию об этом

#### Запуск сервиса

```sh
make run
```


#### Установка окружения

```sh

curl -sSL https://install.python-poetry.org | python3 -

poetry install --with dev, tests

pre-commit install

poetry shell
```

#### Исправить форматирование

```sh

make fix_lint

```

#### Проверить линтером

```sh

make linter

```

#### Тестирование сервиса

```sh

make test

```

#### TODO

1. Перенести настройки приложения Config из FastAPI в Common.AppSettings
2. Сделать cli на основе typer
3. Сделать настоящие юнит-тесты слоя приложения в гексогональных рамках
4. Дописать ручки
5. Сделать воркер чтения изменений и посылки сообшений
